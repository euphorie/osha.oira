<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:meta="http://xml.zope.org/namespaces/meta"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      meta:interpolation="true"
      metal:use-macro="context/@@layout/macros/layout"
      tal:define="
        actions view/actions/values|nothing;
      "
      i18n:domain="nuplone"
>

  <metal:title fill-slot="title">${view/label}</metal:title>
  <metal:content fill-slot="content">
    <div class="container portaltype-${context/portal_type}"
         id="quaive-content"
    >
      <form class="pat-form pat-inject"
            id="${view/id}"
            action="${request/getURL}"
            enctype="${view/enctype}"
            method="${view/method}"
            data-pat-inject="source: #quaive-content; target: #quaive-content"
      >
        <div class="pat-toolbar sticky"
             id="sector-toolbar"
        >
          <div class="toolbar-functions-area pat-inject pat-form pat-autosubmit"
               id="toolbar-functions-area-assessments"
          >
            <div class="toolbar-section quick-functions"
                 id="sector-toolbar-quick-functions"
            >
              <a class="float-after pat-button"
                 href="${here/absolute_url}/@@edit"
                 target="_blank"
                 i18n:translate=""
              >
                <!-- TODO: Remove me -->
                Edit on OiRA
              </a>
              <tal:action repeat="action python:reversed(actions)">
                <button class="pat-button float-after ${python: 'default' if repeat.action.end else ''}"
                        name="${action/name}"
                        type="submit"
                        value="${action/title}"
                >
                  ${action/title}
                </button>
              </tal:action>
            </div>
          </div>
        </div>

        <div class="button-bar"
             tal:condition="actions"
        >
          <!-- TODO: This stuff has to be moved -->
          <tal:versions condition="python:context.portal_type == 'euphorie.survey' and view.is_edit_form">
            <a class="float-after pat-button pat-inject"
               href="${url}"
               data-pat-inject="source: #quaive-content; target: #quaive-content"
               tal:define="
                 url python:request.getURL().replace('quaive-edit', 'quaive-versions');
               "
               i18n:translate=""
            >Publishing options</a>
          </tal:versions>
        </div>

        <div class="container">
          <div class="pat-well">
            <div class="well-title-group">
              <h2 class="well-header">${view/label}</h2>
              <div class="buttons">
                <dfn class="icon help help-icon pat-tooltip tooltip-active-click"
                     data-pat-tooltip="class: info; trigger: click; source: content; position-list: tl"
                     tal:condition="python:getattr(view, 'description', None)"
                >
                  ${view/description}
                </dfn>
              </div>
            </div>

            <p class="message ${python:'error' if view.widgets.errors else 'notice'}"
               tal:define="
                 status view/status;
               "
               tal:condition="status"
               tal:content="status"
               i18n:domain="plone"
            >Form-global message</p>

            <fieldset class="form-panel section horizontal">
              <tal:widget tal:repeat="widget view/widgets/values"
                          content="structure widget/render"
              >
              </tal:widget>
            </fieldset>

          </div>
        </div>

      </form>
    </div>
  </metal:content>
</html>
