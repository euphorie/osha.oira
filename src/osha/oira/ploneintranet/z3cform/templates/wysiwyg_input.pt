<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      tal:define="
        dependencies nocall:view/@@dependencies;
      "
      tal:omit-tag=""
      i18n:domain="nuplone"
>
  <fieldset class="group pat-rich ${dependencies/ploneintranet_classes}"
            data-pat-depends="${dependencies/data_pat_depends}"
  >
    <legend title="${view/field/description}">
      <span tal:replace="view/label"></span>
    </legend>

    <textarea class="${view/klass} pat-tiptap"
              id="${view/id}"
              cols="${view/cols}"
              disabled="${view/disabled}"
              name="${view/name}"
              readonly="${view/readonly}"
              rows="${view/rows}"
              data-pat-tiptap="
                toolbar-external: #assessment-toolbar;
                link-panel: #tiptap-model-hyperlink--fieldname-${view/id} .link-panel;
                link-menu: #tiptap-context-menu-hyperlink--fieldname-${view/id};
                source-panel: #tiptap-model-source-editor--fieldname-${view/id} .source-panel;
              "
    >${view/value}</textarea>
    <metal:help use-macro="view/@@quaive_form_macros/help_tooltip" />

    <!-- modal source editor -->
    <template id="tiptap-modal-source-editor--fieldname-${view/id}">
      <h1>Edit HTML</h1>
      <div class="panel-body source-panel">
        <div class="container">
          <div class="html-source-panel-content">
            <form>
              <textarea class="pat-autofocus"
                        name="tiptap-source"
              ></textarea>
            </form>
          </div>
          <div class="buttons button-bar pat-bumper"
               id="modal-button-bar"
          >
            <button class="pat-button default close-panel icon-ok-circle"
                    name="tiptap-confirm"
                    type="button"
                    i18n:translate=""
            >Apply</button>
            <button class="pat-button close-panel icon-cancel-circle"
                    type="button"
                    i18n:translate=""
            >Cancel</button>
          </div>
        </div>
      </div>
    </template>

    <!-- modal link editor -->
    <template id="tiptap-modal-hyperlink--fieldname-${view/id}">
      <h1>Edit Link</h1>
      <div class="panel-body link-panel">
        <div class="container">
          <form class="pat-form">
            <fieldset class="vertical">
              <fieldset class="group url">
                <legend i18n:translate="">URL</legend>
                <span class="button-field type-url">
                  <input class="pat-autofocus"
                         name="tiptap-href"
                         oninput="if (this.value) { this.nextElementSibling.href = this.value; } else { this.nextElementSibling.removeAttribute('href'); }"
                         type="url"
                         value=""
                  />
                  <a class="follow"
                     id="event-url-follow-button"
                     href=""
                     target="_blank"
                     title="Visit linked web page"
                     i18n:attributes="title"
                     i18n:translate=""
                  >Follow</a>
                </span>
              </fieldset>
              <label>
                <tal:i18n i18n:translate="">Link text</tal:i18n>
                <input name="tiptap-text"
                       type="text"
                />
              </label>
            </fieldset>
          </form>
          <div class="buttons button-bar pat-bumper"
               id="modal-button-bar"
          >
            <button class="pat-button default close-panel icon-ok-circle"
                    name="tiptap-confirm"
                    type="submit"
                    i18n:translate=""
            >Insert</button>
            <button class="pat-button close-panel icon-cancel-circle"
                    type="button"
                    i18n:translate=""
            >Cancel</button>
          </div>
        </div>
      </div>
    </template>

    <!-- context menu link -->
    <template id="tiptap-context-menu-hyperlink--fieldname-${view/id}">
      <ul class="menu tiptap-link-context-menu">
        <li>
          <a class="icon-link close-panel tiptap-open-new-link"
             href=""
             target="_blank"
             i18n:translate=""
          >Visit linked web page</a>
        </li>
        <li>
          <a class="icon-pencil close-panel tiptap-edit-link"
             i18n:translate=""
          >Edit link</a>
        </li>
        <li>
          <a class="icon-unlink close-panel tiptap-unlink"
             i18n:translate=""
          >Unlink</a>
        </li>
      </ul>
    </template>

  </fieldset>
</html>
